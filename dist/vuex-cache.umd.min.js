!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VuexCache={})}(this,(function(e){"use strict";var t=function(e){return!!e&&"object"==typeof e},n=function(e){return t(e[0])?[e[0].type,e[0],e[1]]:e},r=new Error("Can't generate key from parameters."),a=function(e){try{var a=n(e),o=a[0],c=a[1];return o+":"+(t(i=c)?JSON.stringify(i):String(i))}catch(e){return r}var i},o=function(e){return t(e)&&"number"==typeof e.timeout},c=function(e,t){var n="string"==typeof e[0]?e[2]:e[0];return o(n)?n.timeout:o(t)?t.timeout:0},i=function(e){return!!e&&Date.now()>e},u=function(){var e=localStorage.getItem(STORAGE_NAME),t=e&&JSON.parse(e)||[];if(e)for(var n=function(){var e=a[r];e[1].value=new Promise((function(t){t(e[1].value)}))},r=0,a=t;r<a.length;r+=1)n();return new Map(t)}();window.addEventListener("beforeunload",(function(e){for(var t=Array.from(u.entries()),n=function(){var e=a[r];e[1].value instanceof Promise&&e[1].value.then((function(t){e[1].value=t}))},r=0,a=t;r<a.length;r+=1)n();console.log("saveToLocalStorage",t),localStorage.setItem(STORAGE_NAME,JSON.stringify(t))}));var f,l=function(e,o){var f={dispatch:function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var f=a(t);if(f===r)return e.dispatch.apply(e,t);var l=u.get(f)||{},s=l.value,p=l.expiresIn;if(s&&!i(p))return s;var v=c(t,o),h={expiresIn:v?Date.now()+v:void 0,value:e.dispatch.apply(e,t)};return u.set(f,h),console.log(s,"check"),h.value.catch((function(e){return u.delete(f),Promise.reject(e)}))},has:function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var o=a(e);if(o===r)return!1;var c=u.get(o);return t(c)&&!i(c.expiresIn)},clear:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=n(e),a=r[0];return a?Array.from(u.keys()).filter((function(e){return e.split(":")[0]===a})).reduce((function(e,t){return e+u.delete(t)}),0):!!u.clear()},delete:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=a(e);return n!==r&&u.delete(n)},state:function(){return u}};for(var l in Object.defineProperty(e,"cache",{value:f,writable:!1,enumerable:!0,configurable:!1}),e._modulesNamespaceMap){var p=s(e,"mapCacheActions",l);Object.defineProperty(p.context,"cache",{value:f,writable:!1,enumerable:!0,configurable:!1})}},s=function(e,t,n){return e._modulesNamespaceMap[n]},p=(f=function(e,t){var n,r={};return(n=t,Array.isArray(n)?n.map((function(e){return{key:e,val:e}})):Object.keys(n).map((function(e){return{key:e,val:n[e]}}))).forEach((function(t){var n=t.key,a=t.val;r[n]=function(){for(var t=this,n=[],r=arguments.length;r--;)n[r]=arguments[r];var o=this.$store.cache.dispatch;if(e){var c=s(this.$store,"mapCacheActions",e);if(!c)return;o="function"==typeof a?function(n){for(var r,a=[],o=arguments.length-1;o-- >0;)a[o]=arguments[o+1];(r=c.context.cache.dispatch).call.apply(r,[t.$store.cache,""+e+n].concat(a))}:c.context.cache.dispatch}return"function"==typeof a?a.call.apply(a,[this,o].concat(n)):o.call.apply(o,[this.$store.cache,""+e+a].concat(n))}})),r},function(e,t){return"string"!=typeof e?(t=e,e=""):"/"!==e.charAt(e.length-1)&&(e+="/"),f(e,t)});e.cacheAction=function(e,t){return function(n,r){return l(n,t),e.call(this,n,r)}},e.default=function(e){return function(t){return l(t,e)}},e.mapCacheActions=p,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=vuex-cache.umd.min.js.map
